<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="This function can be used on wide-form data frames to summarise the proportion of rows, instances or of a total, which exhibits each of the characteristics fed into the function. Each subgroup (characeteristic) must be a column in the data frame. ">
<title>Functions for data analysis and manipulation by Thomas Harris • THfuncs</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Functions for data analysis and manipulation by Thomas Harris">
<meta property="og:description" content="This function can be used on wide-form data frames to summarise the proportion of rows, instances or of a total, which exhibits each of the characteristics fed into the function. Each subgroup (characeteristic) must be a column in the data frame. ">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">THfuncs</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="thfuncs">THfuncs<a class="anchor" aria-label="anchor" href="#thfuncs"></a>
</h1></div>
</div>
<div class="section level1">
<h1 id="purpose">Purpose<a class="anchor" aria-label="anchor" href="#purpose"></a>
</h1>
<p>The THfuncs R package contains functions created to help with data analysis, data manipulation and other functionality in R.</p>
<p>The first (and currently only function) contained in this package is <code><a href="reference/prop_in_group.html">prop_in_group()</a></code>. This function transforms tidy data into a grouped proportion table, using columns in the data. It can be generalised to summarise wide data frames, as shown in the examples below.</p>
</div>
<div class="section level1">
<h1 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h1>
<p>You can install the development version of THfuncs like so:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># install.packages("devtools")</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/" class="external-link">devtools</a></span><span class="op">)</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org/reference/remote-reexports.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"tomambroseharris/THfuncs"</span>, force <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">THfuncs</span><span class="op">)</span></code></pre></div>
<div class="section level2">
<h2 id="prop_in_group">prop_in_group<a class="anchor" aria-label="anchor" href="#prop_in_group"></a>
</h2>
<p>See what the function does by running: <code>?prop_in_group()</code> The inputs are shown in <code>Usage</code>. There are defaults, which mean that the only arguments necessary to specify are the <code>input_df</code> and <code>breakdowns_vector</code>.</p>
<p>The function takes a data frame and summarises how values within the whole data frame are split between various groups. The function’s flexibility enables this to take many forms, it also allows users to account for things including: NA (unknown) values; whether the data are to be counted in instances or whether they already have attributed numeric values; multiple groups and subgroups; and stacking groups.</p>
<p>The function produces a data frame with 5 core columns:</p>
<ul>
<li>
<strong>Grouping</strong> - the overarching data group: a column name in the original df</li>
<li>
<strong>Subgroup</strong> - the labels within the overarching group: unique inputs in the grouping col from the original df</li>
<li>
<strong>Proportion</strong> - the proportion of the overall value made up by that subgroup</li>
<li>
<strong>Known in Group</strong> - how many non-NA values were included in the calculation</li>
<li>
<strong>Unknowns</strong> - how many NA values were excluded from the calculation</li>
</ul>
<p>The number of columns will vary if multiple subgroups are incorporated or if users choose to deselect the knowns columns. These are included by default because they aid understanding of the function.</p>
</div>
</div>
<div class="section level1">
<h1 id="example-use">Example use<a class="anchor" aria-label="anchor" href="#example-use"></a>
</h1>
<p>We will use some dummy data on universities, shown below.</p>
<table class="table">
<colgroup>
<col width="8%">
<col width="25%">
<col width="8%">
<col width="15%">
<col width="8%">
<col width="15%">
<col width="16%">
</colgroup>
<thead><tr class="header">
<th align="right">UKPRN</th>
<th align="left">Name</th>
<th align="left">Country</th>
<th align="left">Ofs_Tariff_1920</th>
<th align="left">TEF_1819</th>
<th align="right">Student numbers</th>
<th align="right">Total Expenditure</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">10007814</td>
<td align="left">Cardiff University</td>
<td align="left">Wales</td>
<td align="left">NA</td>
<td align="left">Silver</td>
<td align="right">33510</td>
<td align="right">573201</td>
</tr>
<tr class="even">
<td align="right">10007790</td>
<td align="left">The University of Edinburgh</td>
<td align="left">Scotland</td>
<td align="left">NA</td>
<td align="left">No TEF</td>
<td align="right">37830</td>
<td align="right">1060066</td>
</tr>
<tr class="odd">
<td align="right">10007794</td>
<td align="left">The University of Glasgow</td>
<td align="left">Scotland</td>
<td align="left">NA</td>
<td align="left">No TEF</td>
<td align="right">37145</td>
<td align="right">695820</td>
</tr>
<tr class="even">
<td align="right">10000291</td>
<td align="left">Anglia Ruskin University</td>
<td align="left">England</td>
<td align="left">Low Tariff</td>
<td align="left">Silver</td>
<td align="right">32180</td>
<td align="right">270231</td>
</tr>
<tr class="odd">
<td align="right">10008640</td>
<td align="left">Falmouth University</td>
<td align="left">England</td>
<td align="left">Specialist HEI</td>
<td align="left">Gold</td>
<td align="right">6170</td>
<td align="right">64303</td>
</tr>
<tr class="even">
<td align="right">10007760</td>
<td align="left">Birkbeck College</td>
<td align="left">England</td>
<td align="left">Specialist HEI</td>
<td align="left">Silver</td>
<td align="right">12070</td>
<td align="right">106783</td>
</tr>
<tr class="odd">
<td align="right">10007792</td>
<td align="left">University of Exeter</td>
<td align="left">England</td>
<td align="left">High Tariff</td>
<td align="left">Gold</td>
<td align="right">30250</td>
<td align="right">512915</td>
</tr>
<tr class="even">
<td align="right">10007799</td>
<td align="left">University of Newcastle</td>
<td align="left">England</td>
<td align="left">High Tariff</td>
<td align="left">Gold</td>
<td align="right">27775</td>
<td align="right">530603</td>
</tr>
<tr class="odd">
<td align="right">10007154</td>
<td align="left">University of Nottingham</td>
<td align="left">England</td>
<td align="left">High Tariff</td>
<td align="left">Gold</td>
<td align="right">35785</td>
<td align="right">683714</td>
</tr>
</tbody>
</table>
<div class="section level3">
<h3 id="example-1---basic">Example 1. - Basic<a class="anchor" aria-label="anchor" href="#example-1---basic"></a>
</h3>
<p>Showing the proportion of observations (rows) that have each breakdown.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/prop_in_group.html">prop_in_group</a></span><span class="op">(</span>input_df <span class="op">=</span> <span class="va">universities</span>,
              breakdowns_vector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Country"</span>, <span class="st">"Ofs_Tariff_1920"</span>, <span class="st">"TEF_1819"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<table class="table">
<colgroup>
<col width="23%">
<col width="22%">
<col width="16%">
<col width="22%">
<col width="14%">
</colgroup>
<thead><tr class="header">
<th align="left">Grouping</th>
<th align="left">Subgroup</th>
<th align="right">Proportion</th>
<th align="right">Known in Group</th>
<th align="right">Unknowns</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Country</td>
<td align="left">England</td>
<td align="right">0.67</td>
<td align="right">9</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">Country</td>
<td align="left">Scotland</td>
<td align="right">0.22</td>
<td align="right">9</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">Country</td>
<td align="left">Wales</td>
<td align="right">0.11</td>
<td align="right">9</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">Ofs_Tariff_1920</td>
<td align="left">High Tariff</td>
<td align="right">0.50</td>
<td align="right">6</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">Ofs_Tariff_1920</td>
<td align="left">Low Tariff</td>
<td align="right">0.17</td>
<td align="right">6</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">Ofs_Tariff_1920</td>
<td align="left">Specialist HEI</td>
<td align="right">0.33</td>
<td align="right">6</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">TEF_1819</td>
<td align="left">Gold</td>
<td align="right">0.44</td>
<td align="right">9</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">TEF_1819</td>
<td align="left">No TEF</td>
<td align="right">0.22</td>
<td align="right">9</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">TEF_1819</td>
<td align="left">Silver</td>
<td align="right">0.33</td>
<td align="right">9</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p><strong>Notes:</strong> <em>Only the rows for which the data points are known will be included in the calculation, this ensures that the proportion sums to 1 within each grouping.</em> <em>Because there are 9 observations, the <code>Known in Group</code> and <code>Unknowns</code> columns will sum to 9, depending on whether the subgroup value contains data or is an NA</em></p>
</div>
<div class="section level3">
<h3 id="example-2a---proportion-of-student-numbers">Example 2a. - Proportion of student numbers<a class="anchor" aria-label="anchor" href="#example-2a---proportion-of-student-numbers"></a>
</h3>
<p>Showing the proportion of observations (rows) that have each breakdown. SUM how much of the total is known.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/prop_in_group.html">prop_in_group</a></span><span class="op">(</span>input_df <span class="op">=</span> <span class="va">universities</span>,
              breakdowns_vector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Country"</span>, <span class="st">"Ofs_Tariff_1920"</span>, <span class="st">"TEF_1819"</span><span class="op">)</span>,
              value_col <span class="op">=</span> <span class="va">`Student numbers`</span>,
              knowns_treatment <span class="op">=</span> <span class="st">"sum"</span><span class="op">)</span></code></pre></div>
<table class="table">
<colgroup>
<col width="23%">
<col width="22%">
<col width="16%">
<col width="22%">
<col width="14%">
</colgroup>
<thead><tr class="header">
<th align="left">Grouping</th>
<th align="left">Subgroup</th>
<th align="right">Proportion</th>
<th align="right">Known in Group</th>
<th align="right">Unknowns</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Country</td>
<td align="left">England</td>
<td align="right">0.57</td>
<td align="right">252715</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">Country</td>
<td align="left">Scotland</td>
<td align="right">0.30</td>
<td align="right">252715</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">Country</td>
<td align="left">Wales</td>
<td align="right">0.13</td>
<td align="right">252715</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">Ofs_Tariff_1920</td>
<td align="left">High Tariff</td>
<td align="right">0.65</td>
<td align="right">144230</td>
<td align="right">108485</td>
</tr>
<tr class="odd">
<td align="left">Ofs_Tariff_1920</td>
<td align="left">Low Tariff</td>
<td align="right">0.22</td>
<td align="right">144230</td>
<td align="right">108485</td>
</tr>
<tr class="even">
<td align="left">Ofs_Tariff_1920</td>
<td align="left">Specialist HEI</td>
<td align="right">0.13</td>
<td align="right">144230</td>
<td align="right">108485</td>
</tr>
<tr class="odd">
<td align="left">TEF_1819</td>
<td align="left">Gold</td>
<td align="right">0.40</td>
<td align="right">252715</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">TEF_1819</td>
<td align="left">No TEF</td>
<td align="right">0.30</td>
<td align="right">252715</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">TEF_1819</td>
<td align="left">Silver</td>
<td align="right">0.31</td>
<td align="right">252715</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="example-2b---proportion-of-student-numbers">Example 2b. - Proportion of student numbers<a class="anchor" aria-label="anchor" href="#example-2b---proportion-of-student-numbers"></a>
</h3>
<p>Showing the proportion of observations (rows) that have each breakdown. COUNT how many rows have known values. (This is the default, as shown in example 1).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/prop_in_group.html">prop_in_group</a></span><span class="op">(</span>input_df <span class="op">=</span> <span class="va">universities</span>,
              breakdowns_vector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Country"</span>, <span class="st">"Ofs_Tariff_1920"</span>, <span class="st">"TEF_1819"</span><span class="op">)</span>,
              value_col <span class="op">=</span> <span class="va">`Student numbers`</span>,
              knowns_treatment <span class="op">=</span> <span class="st">"count"</span><span class="op">)</span></code></pre></div>
<p><strong>Notes</strong> <em>The proportion of student numbers is still the same as in 2a, because the calculation is still the same. All that has changed is the presentation of how many of the rows contain known values</em></p>
<table class="table">
<colgroup>
<col width="23%">
<col width="22%">
<col width="16%">
<col width="22%">
<col width="14%">
</colgroup>
<thead><tr class="header">
<th align="left">Grouping</th>
<th align="left">Subgroup</th>
<th align="right">Proportion</th>
<th align="right">Known in Group</th>
<th align="right">Unknowns</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Country</td>
<td align="left">England</td>
<td align="right">0.57</td>
<td align="right">9</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">Country</td>
<td align="left">Scotland</td>
<td align="right">0.30</td>
<td align="right">9</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">Country</td>
<td align="left">Wales</td>
<td align="right">0.13</td>
<td align="right">9</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">Ofs_Tariff_1920</td>
<td align="left">High Tariff</td>
<td align="right">0.65</td>
<td align="right">6</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">Ofs_Tariff_1920</td>
<td align="left">Low Tariff</td>
<td align="right">0.22</td>
<td align="right">6</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">Ofs_Tariff_1920</td>
<td align="left">Specialist HEI</td>
<td align="right">0.13</td>
<td align="right">6</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">TEF_1819</td>
<td align="left">Gold</td>
<td align="right">0.40</td>
<td align="right">9</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">TEF_1819</td>
<td align="left">No TEF</td>
<td align="right">0.30</td>
<td align="right">9</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">TEF_1819</td>
<td align="left">Silver</td>
<td align="right">0.31</td>
<td align="right">9</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="example-2c---rounded-knowns">Example 2c. - Rounded knowns<a class="anchor" aria-label="anchor" href="#example-2c---rounded-knowns"></a>
</h3>
<p>Now we change the input parameter <code>round_knowns_to_nearest</code> from 1 (the default) to 5. This can help to produce tables that comply with rounding rules or presentation intentions.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prop_in_group</span>(<span class="at">input_df =</span> universities,</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">breakdowns_vector =</span> <span class="fu">c</span>(<span class="st">"Country"</span>, <span class="st">"Ofs_Tariff_1920"</span>, <span class="st">"TEF_1819"</span>),</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">value_col =</span> <span class="st">`</span><span class="at">Student numbers</span><span class="st">`</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">round_knowns_to_nearest =</span> <span class="dv">5</span>)</span></code></pre></div>
<table class="table">
<colgroup>
<col width="23%">
<col width="22%">
<col width="16%">
<col width="22%">
<col width="14%">
</colgroup>
<thead><tr class="header">
<th align="left">Grouping</th>
<th align="left">Subgroup</th>
<th align="right">Proportion</th>
<th align="right">Known in Group</th>
<th align="right">Unknowns</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Country</td>
<td align="left">England</td>
<td align="right">0.57</td>
<td align="right">10</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">Country</td>
<td align="left">Scotland</td>
<td align="right">0.30</td>
<td align="right">10</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">Country</td>
<td align="left">Wales</td>
<td align="right">0.13</td>
<td align="right">10</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">Ofs_Tariff_1920</td>
<td align="left">High Tariff</td>
<td align="right">0.65</td>
<td align="right">5</td>
<td align="right">5</td>
</tr>
<tr class="odd">
<td align="left">Ofs_Tariff_1920</td>
<td align="left">Low Tariff</td>
<td align="right">0.22</td>
<td align="right">5</td>
<td align="right">5</td>
</tr>
<tr class="even">
<td align="left">Ofs_Tariff_1920</td>
<td align="left">Specialist HEI</td>
<td align="right">0.13</td>
<td align="right">5</td>
<td align="right">5</td>
</tr>
<tr class="odd">
<td align="left">TEF_1819</td>
<td align="left">Gold</td>
<td align="right">0.40</td>
<td align="right">10</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">TEF_1819</td>
<td align="left">No TEF</td>
<td align="right">0.30</td>
<td align="right">10</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">TEF_1819</td>
<td align="left">Silver</td>
<td align="right">0.31</td>
<td align="right">10</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="example-3---dual-breakdowns">Example 3. - Dual breakdowns<a class="anchor" aria-label="anchor" href="#example-3---dual-breakdowns"></a>
</h3>
<p>Now we will derive the proportion in each group split by the unique variables in the <code>Country</code> column. Grouping</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="reference/prop_in_group.html">prop_in_group</a></span><span class="op">(</span>input_df <span class="op">=</span> <span class="va">universities</span>,
              breakdowns_vector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"TEF_1819"</span><span class="op">)</span>,
              value_col <span class="op">=</span> <span class="va">`Student numbers`</span>,
              group_by_col <span class="op">=</span> <span class="va">Country</span><span class="op">)</span></code></pre></div>
<table class="table">
<colgroup>
<col width="13%">
<col width="13%">
<col width="9%">
<col width="13%">
<col width="12%">
<col width="22%">
<col width="13%">
</colgroup>
<thead><tr class="header">
<th align="left">Grouping</th>
<th align="left">Subgroup</th>
<th align="right">Wales</th>
<th align="right">Scotland</th>
<th align="right">England</th>
<th align="right">Known in Group</th>
<th align="right">Unknowns</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">TEF_1819</td>
<td align="left">Gold</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">0.69</td>
<td align="right">9</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">TEF_1819</td>
<td align="left">No TEF</td>
<td align="right">NA</td>
<td align="right">1</td>
<td align="right">NA</td>
<td align="right">9</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">TEF_1819</td>
<td align="left">Silver</td>
<td align="right">1</td>
<td align="right">NA</td>
<td align="right">0.31</td>
<td align="right">9</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p><strong>Notes</strong> <em>Where there are no corresponding data in the original data frame (e.g., No Welsh universities in the df were TEF_1819 = Gold), NA will be returned</em></p>
</div>
<div class="section level3">
<h3 id="example-4-rounding-the-proportion">Example 4: rounding the proportion<a class="anchor" aria-label="anchor" href="#example-4-rounding-the-proportion"></a>
</h3>
<p>The <code>prop_dps</code> argument allows you to change the accuracy of the proportions</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="reference/prop_in_group.html">prop_in_group</a></span><span class="op">(</span>input_df <span class="op">=</span> <span class="va">universities</span>,
              breakdowns_vector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"TEF_1819"</span><span class="op">)</span>,
              value_col <span class="op">=</span> <span class="va">`Student numbers`</span>,
              prop_dps <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">Grouping</th>
<th align="left">Subgroup</th>
<th align="right">Proportion</th>
<th align="right">Known in Group</th>
<th align="right">Unknowns</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">TEF_1819</td>
<td align="left">Gold</td>
<td align="right">0.3956</td>
<td align="right">9</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">TEF_1819</td>
<td align="left">No TEF</td>
<td align="right">0.2967</td>
<td align="right">9</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">TEF_1819</td>
<td align="left">Silver</td>
<td align="right">0.3077</td>
<td align="right">9</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="example-5---minimalist-table-without-knowns-and-within-pipe">Example 5. - Minimalist table without knowns and within pipe<a class="anchor" aria-label="anchor" href="#example-5---minimalist-table-without-knowns-and-within-pipe"></a>
</h3>
<p>This table summarises the proportion of universities in each tariff group. Instead of ignoring NA values, we can reassign these values such that they are included in the proportion calculation. If this is the case, we might as well remove the <code>Known in Group</code> and <code>Unknowns</code> columns (because these would be Known = 9 and Unknowns = 0 in each instance).</p>
<p>This table also shows how the function can be nested within a pipe: it assumes that the input data frame is that which is being manipulated.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R">

<span class="va">output_df</span> <span class="op">&lt;-</span> <span class="va">universities</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span>Ofs_Tariff_1920 <span class="op">=</span> <span class="fu">if_else</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">Ofs_Tariff_1920</span><span class="op">)</span>, <span class="st">"UNKNOWN TARIFF"</span>, <span class="va">Ofs_Tariff_1920</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="reference/prop_in_group.html">prop_in_group</a></span><span class="op">(</span>breakdowns_vector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Ofs_Tariff_1920"</span><span class="op">)</span>,
                show_knowns_cols <span class="op">=</span> <span class="st">"no"</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">Grouping</th>
<th align="left">Subgroup</th>
<th align="right">Proportion</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Ofs_Tariff_1920</td>
<td align="left">High Tariff</td>
<td align="right">0.33</td>
</tr>
<tr class="even">
<td align="left">Ofs_Tariff_1920</td>
<td align="left">Low Tariff</td>
<td align="right">0.11</td>
</tr>
<tr class="odd">
<td align="left">Ofs_Tariff_1920</td>
<td align="left">Specialist HEI</td>
<td align="right">0.22</td>
</tr>
<tr class="even">
<td align="left">Ofs_Tariff_1920</td>
<td align="left">UNKNOWN TARIFF</td>
<td align="right">0.33</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="example-6-summed-values-not-proportions">Example 6: Summed values not proportions<a class="anchor" aria-label="anchor" href="#example-6-summed-values-not-proportions"></a>
</h3>
<p>The function can be changed to sum the value column (or count instances if no <code>value_col</code> is parsed). This option creates an entirely different df rather than adding to the existing df because of issues when more than one grouping column are included. To get them alongside, you’d have to run the function twice and join them.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="reference/prop_in_group.html">prop_in_group</a></span><span class="op">(</span>input_df <span class="op">=</span> <span class="va">universities</span>,
              breakdowns_vector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"TEF_1819"</span><span class="op">)</span>,
              value_col <span class="op">=</span> <span class="va">`Student numbers`</span>,
              value_or_prop <span class="op">=</span> <span class="st">"value"</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">Grouping</th>
<th align="left">Subgroup</th>
<th align="right">Value</th>
<th align="right">Known in Group</th>
<th align="right">Unknowns</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">TEF_1819</td>
<td align="left">Gold</td>
<td align="right">99980</td>
<td align="right">9</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">TEF_1819</td>
<td align="left">No TEF</td>
<td align="right">74975</td>
<td align="right">9</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">TEF_1819</td>
<td align="left">Silver</td>
<td align="right">77760</td>
<td align="right">9</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="example-7-transforming-knowns-and-nas">Example 7: transforming knowns and NAs<a class="anchor" aria-label="anchor" href="#example-7-transforming-knowns-and-nas"></a>
</h3>
<p>Here is an example of how to get your unknown values into NA form. an easy way to do this is <code><a href="https://dplyr.tidyverse.org/reference/na_if.html" class="external-link">dplyr::na_if()</a></code>. An example of the syntax to be applied is below.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R">

<span class="va">output_df</span> <span class="op">&lt;-</span> <span class="va">universities</span> <span class="op">%&gt;%</span>
   <span class="fu">mutate</span><span class="op">(</span>TEF_1819 <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/na_if.html" class="external-link">na_if</a></span><span class="op">(</span><span class="va">TEF_1819</span>, <span class="st">"No TEF"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
<span class="fu"><a href="reference/prop_in_group.html">prop_in_group</a></span><span class="op">(</span>breakdowns_vector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"TEF_1819"</span><span class="op">)</span>,
              value_col <span class="op">=</span> <span class="va">`Student numbers`</span>,
              value_or_prop <span class="op">=</span> <span class="st">"value"</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">Grouping</th>
<th align="left">Subgroup</th>
<th align="right">Value</th>
<th align="right">Known in Group</th>
<th align="right">Unknowns</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">TEF_1819</td>
<td align="left">Gold</td>
<td align="right">99980</td>
<td align="right">7</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">TEF_1819</td>
<td align="left">Silver</td>
<td align="right">77760</td>
<td align="right">7</td>
<td align="right">2</td>
</tr>
</tbody>
</table>
</div>
</div>

  </main><aside class="col-md-3"><div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-3" class="external-link">GPL-3</a></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing THfuncs</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Tom Harris <br><small class="roles"> Maintainer </small>  </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Tom Harris.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
